{% extends "layouts/base.html" %}

{% block content %}
  {% include "components/header.html" %}
  {% set previousPost = collections['blog-post'] | getPreviousCollectionItem %}
  {% set nextPost = collections['blog-post'] | getNextCollectionItem %}

  <main id="main-content" class="main-content h-entry">
    <article>
      <h1 class="p-name">{{title}}</h1>

      <ul class="post-subtitle">
        <li class="post-date">
          Written: {{date|formatDate("LLLL dd, yyyy")}}
        </li>
        <li class="post-stats">
          ~{{content|wordStats}}
        </li>
        <li>
          <ul class="post-tags">
            {%- for tag in tags -%}
              {% if tag != "blog-post" %}
                <li>
                  <a href="/tags/{{ tag }}">#{{ tag | unslugify }}</a>
                </li>
              {% endif %}
            {%- endfor -%}
          </ul>
        </li>
      </ul>

      {% if postmedia.videos or postmedia.images%}
        <section class="splide" aria-label="Gallery carousel">
          <div class="splide__track">
            <ul class="splide__list">
              {% if postmedia.images %}
                {% for item in postmedia.images %}
                  <li class="splide__slide">
                    <img src="{{item.url}}" alt="{{item.alt}}"/>
                  </li>
                {% endfor %}
              {% endif %}
              {% if postmedia.videos %}
                {% for item in postmedia.videos %}
                  <li class="splide__slide">
                    {{ item.url | safe }}
                  </li>
                {% endfor %}
              {% endif %}
            </ul>
          </div>
        </section>
      {% endif %}

      <div class="e-content">{{ content | safe }}</div>
    </article>
  </main>

  <footer id="post-footer" class="post-footer">
    <nav>
      {% if nextPost %}
        <p>
          <a class="nxt-btn" href="{{ nextPost.url }}">
           ◄ {{ nextPost.data.title }}</a>
        </p>
      {% endif %}
      {% if previousPost %}
        <p>
          <a class="prev-btn" href="{{ previousPost.url }}">
            {{ previousPost.data.title }} ►</a>
        </p>
      {% endif %}
    </nav>

    {% include "components/webmentions.html" %}

  </footer>
{% endblock %}

{% block stylesheet %}
  <link rel="stylesheet" href="/css/components/header.css">
  <link rel="stylesheet" href="/css/components/post-list.css">
  <link rel="stylesheet" href="/css/blog-post.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">
  <link
    href="https://npm.elemecdn.com/prism-themes/themes/prism-vs.css"
    rel="stylesheet"
    media="(prefers-color-scheme: light)"/>
  <link
    href="https://npm.elemecdn.com/prism-themes/themes/prism-material-dark.css"
    rel="stylesheet"
    media="(prefers-color-scheme: dark)"/>
{% endblock %}
{% block script %}
  <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
  <script src="/js/blog-post.js" defer></script>
{% endblock %}